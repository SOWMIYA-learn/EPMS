{% extends 'layout.html' %}
{% block content %}
<div class="max-w-3xl mx-auto bg-white p-6 rounded shadow">
  <div class="flex justify-between items-start">
    <div>
      <h2 class="text-2xl font-semibold text-indigo-700">{{ patient.name }}</h2>
      <p class="text-sm text-gray-500">{{ patient.patient_id }}</p>
    </div>
    <div>
      <img src="{{ qr }}" alt="QR" class="w-24 h-24 rounded border">
    </div>
  </div>

  <div class="mt-4 grid grid-cols-2 gap-3 text-sm">
    <div><strong>Age:</strong> {{ patient.age or 'N/A' }}</div>
    <div><strong>Gender:</strong> {{ patient.gender or 'N/A' }}</div>
    <div><strong>Ailment:</strong> {{ patient.ailment or 'N/A' }}</div>
    <div><strong>Contact:</strong> {{ patient.contact or 'N/A' }}</div>
    <div class="md:col-span-2"><strong>Address:</strong> {{ patient.address or 'N/A' }}</div>
  </div>

  <div class="mt-4 flex gap-3">
    <a href="{{ url_for('edit_patient', id=patient.id) }}" class="bg-yellow-500 text-white px-4 py-2 rounded">Edit</a>
    <form action="{{ url_for('delete_patient', id=patient.id) }}" method="post" onsubmit="return confirm('Delete?')">
      <button class="bg-red-500 text-white px-4 py-2 rounded">Delete</button>
    </form>
    <a href="{{ url_for('patients_table') }}" class="ml-auto text-indigo-600">Back to list</a>
  </div>

  <hr class="my-4">

  <h3 class="text-lg font-semibold mb-2">Reports</h3>
  <form action="{{ url_for('upload_report', patient_id=patient.id) }}" method="post" enctype="multipart/form-data">
    <input type="file" name="report" accept=".pdf,.png,.jpg,.jpeg" required>
    <button class="bg-indigo-600 text-white px-3 py-1 rounded ml-2">Upload</button>
  </form>

  <ul class="mt-3 space-y-2">
    {% for r in patient.reports %}
      <li class="flex items-center gap-3">
        <a href="{{ url_for('uploads', filename=r.filename) }}" class="text-indigo-600">{{ r.filename }}</a>
        <a href="{{ url_for('report_view', report_id=r.id) }}" class="text-sm text-gray-500 ml-2">View</a>
      </li>
    {% else %}
      <li class="text-gray-500">No reports uploaded.</li>
    {% endfor %}
  </ul>

</div>
{% endblock %}
